<!doctype html>
<html>
  <head>
      <meta name='viewport' content='width=device-width, initial-scale=1.0'>
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
      <link href="/static/img/icon.ico" rel="shortcut icon" type="image/x-icon">
      <title>sol - {{ page }}페이지</title>
      <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
      <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8112542064837410" crossorigin="anonymous"></script>
      <script type="text/javascript" src="//wcs.naver.net/wcslog.js"></script>
      <script type="text/javascript">
          if(!wcs_add) var wcs_add = {};
          wcs_add["wa"] = "cd98fcfc8e2110";
          if(window.wcs) {
          wcs_do();
          }
      </script> 
      <style>
         tr{cursor:pointer;} 
      </style>
  </head>
  <body>
      <div class='container'>
        <a href="/">홈</a><button style="float: right;" type="button" onclick="window.location='/board/new'" class="btn btn-light pull-right">글쓰기</button>
        <h1>{{ tag }}</h1>
        <table class="table table-hover table-striped">
          <thead>
            <tr>
              <th>제목</th>
              <th>글쓴이</th>
              <th>날짜</th>
            </tr>
          </thead>
          <tbody id="tbody">
            {% for i in length %}
            <a href="/board/post/{{ posts[i][1] }}"></a><tr onclick="window.location = '/board/post/{{ posts[i][1] }}'"><td>{{ posts[i][0] }}</td><td>{{ posts[i][3] }}</td><td>{{ posts[i][2] }}</td></tr>
            {% endfor %}
          </tbody>
        </table>
        <hr/>
        <button style="float: right;" type="button" onclick="window.location='/board/new'" class="btn btn-light pull-right">글쓰기</button>
        <div style="margin-left: 40%;">
          <ul class="pagination">
            <li class="page-item"><a class="page-link" href="/board/list/{{ page - 1 }}">{{ page - 1 }}</a></li>
            <li class="page-item"><a class="page-link" href="/board/list/{{ page }}">{{ page }}</a></li>
            <li class="page-item"><a class="page-link" href="/board/list/{{ page + 1 }}">{{ page + 1 }}</a></li>
          </ul>
        </div>
      </div>
      <script>
        var Visible = {{ page }};
        setInterval(function() {
            if (checkVisible($('#event'))) {
              content = $.get("/board/list/load/" + Visible);
              $("#tbody").html($("#tbody").html() + content.responseText);
              Visible++;
              $('#event').remove();
            }
        }, 2000);
        function checkVisible( elm, eval ) {
            eval = eval || "object visible";
            var viewportHeight = $(window).height(), // Viewport Height
                scrolltop = $(window).scrollTop(), // Scroll Top
                y = $(elm).offset().top,
                elementHeight = $(elm).height();   
            
            if (eval == "object visible") return ((y < (viewportHeight + scrolltop)) && (y > (scrolltop - elementHeight)));
            if (eval == "above") return ((y < (viewportHeight + scrolltop)));
        }
        
      </script>
      
      {% with messages = get_flashed_messages() %}
      {% if messages %}
          <script>
          {% for message in messages %}
              alert("{{ message }}");
          {% endfor %}
          </script>
      {% endif %}
      {% endwith %}
      {% block body %}{% endblock %}
  </body>
</html>
